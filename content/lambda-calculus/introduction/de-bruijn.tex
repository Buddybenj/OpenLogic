% Part: lambda-calculus
% Chapter: introduction
% Section: alpha

\documentclass[../../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{lc}{int}{alp}
\olsection{De Bruijn index}

Because the $\alpha$-equivalence comes so naturally, some syntax has
been invented that doesn't distinguish terms that can be
$\alpha$-converted to each other, among which the most well-known is the
\emph{De Bruijn index}.

When we write $\lambd[x][M]$, we explicitly state that $x$ is the
parameter of the function, so that we can use $x$ in $M$ to refer
to this parameter. In De Bruijn index, however, parameters have no
name and reference to them in function body is denoted by a number
denoting the levels of abstraction between them. For example, consider
the example of $\lambd[x][lambd[y][y x]]$: the outer  abstraction
is on level $0$ and the binding variable is $x$; the inner abstraction
is on level $1$ and the binding variable is $y$; the sub-term $y x$
lies in the inner abstraction whose level is $1$. Thus we
write $0 1$ for $y x$.

\begin{defn}
  De Bruijn terms is inductively defines as follows:
  \begin{enumerate}
  \item $n$, where $n$ is any natural number.
  \item $PQ$, where $P$ and $Q$ are both De Bruijn terms.
  \item $\lambd[][N]$, where $N$ is a De Bruijn term.
  \end{enumerate}
\end{defn}

A formalized translation from common lambda terms to De Bruijn indexed
terms is as follows:
\begin{defn}
  \begin{align*}
    F_\Gamma(x) &= \Gamma(x) \\
    F_\Gamma(PQ) &= F_\Gamma(P)F_\Gamma(Q) \\
    F_\Gamma(\lambd[x][N]) &= \lambd[][F_{x,\Gamma}(N)]
  \end{align*}
  where $\Gamma$ is a list of variables indexed from zero, and
  $\Gamma(x)$ denotes the position of the variable $x$ in $\Gamma$;
  for example, if $\Gamma$ is $x,y,z$, then $\Gamma(x)$ is $0$ and
  $\Gamma(z)$ is $2$.
  
  $x,\Gamma$ denotes the list resulted from pushing $x$ to the head of
  $\Gamma$; for instance, continuing the $\Gamma$ in last example,
  $w,\Gamma$ is $w,x,y,z$.
\end{defn}

Recovering from De Bruijn term to a normal term is as follows:
\begin{defn}
  \begin{align*}
    G_\Gamma(n) &= \Gamma[n] \\
    G_\Gamma(PQ) &= G_\Gamma(P) G_\Gamma(Q) \\
    G_\Gamma(\lambd[][N]) &= \lambd[x][G_{x,\Gamma}(N)]
  \end{align*}
  where $\Gamma$ is again a list of variables indexed from zero, and
  $\Gamma[n]$ denotes the variable on the position $n$; for example,
  if $\Gamma$ is $x,y,z$, then $\Gamma[1]$ is $y$.

  The variable $x$ in last equation is chosen to be any variable that
  not in $\Gamma$.
\end{defn}

Here we give some results without proving them:
\begin{prop}
  If $M \aconvone M'$, and $\Gamma$ is any list containing $FV(M)$, then
  $F_\Gamma(M) \eqs F_\Gamma(M')$.
\end{prop}

Besides the De Bruijn index, we can also utilize $\alpha$-equivalence
by $\alpha$-equivalence class (\olref[sfr][rel][prp]{sec}), which is
the approach we will see in next section and use in rest of the part.
\end{document}
